<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>West Vancouver Building Permit Application</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      line-height: 1.6;
    }
    .form-section {
      margin-bottom: 20px;
    }
    .hidden {
      display: none;
    }
    .success {
      color: green;
      font-weight: bold;
    }
    .error {
      color: red;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>West Vancouver Building Permit Application</h1>
  
  <!-- Address Input Section -->
  <div class="form-section">
    <label for="address">Property Address:</label>
    <input type="text" id="address" placeholder="Enter property address" required>
    <button onclick="fetchPropertyInfo()">Search Property Info</button>
    <p id="addressFeedback"></p>
  </div>
  
  <!-- Zoning Information -->
  <div class="form-section hidden" id="zoningSection">
    <h3>Property Zoning:</h3>
    <p id="zoningInfo"></p>
  </div>

  <!-- Scope of Work -->
  <div class="form-section hidden" id="scopeSection">
    <label for="scope">Scope of Work:</label>
    <select id="scope" onchange="updateRequirements()">
      <option value="" disabled selected>Select Scope</option>
    </select>
  </div>

  <!-- Dynamic Requirements Checklist -->
  <div class="form-section hidden" id="requirementsSection">
    <h3>Required Documentation:</h3>
    <ul id="requirementsList"></ul>
  </div>

  <script>
    // Mock database to simulate property data
    const mockDatabase = {
      "123 Main St": {
        zoning: "RS-1 (Single-Family)",
        permits: ["pool", "hotTub", "retainingWalls"]
      },
      "456 Oak Ave": {
        zoning: "RM-2 (Multi-Family)",
        permits: ["secondarySuite", "solarPanels", "renovationAddition"]
      },
      "789 Pine Rd": {
        zoning: "CD-1 (Comprehensive Development)",
        permits: ["pool", "solarPanels", "renovationAddition"]
      }
    };

    // Document requirements based on permit type
    const documentRequirements = {
      pool: [
        "2 Site Plans (property lines, pool dimensions, mechanical room)",
        "2 Copies of structural drawings",
        "Geotechnical Schedule B & C",
        "Structural Schedule B & C",
        "Sections of infinity edge or retaining wall (if applicable)"
      ],
      hotTub: [
        "Survey by BC Land Surveyor",
        "2 Site Plans (location and grade details)",
        "Structural Schedules B & C"
      ],
      retainingWalls: [
        "2 Sealed BCLS Surveys",
        "Topographic data and property-line dimensions",
        "Geotechnical and Structural Schedules"
      ],
      secondarySuite: [
        "Site plan (parking, setbacks, egress)",
        "Suite floor plan (window/door sizes, sprinkler info, alarms, separation walls)"
      ],
      solarPanels: [
        "Roof plan, structural drawings, and compliance with Canadian Electrical Code"
      ],
      renovationAddition: [
        "Scope of work letter",
        "Title search",
        "Code review (door/window sizes, RSI calcs, setbacks)"
      ]
    };

    // Validate and fetch property info
    function fetchPropertyInfo() {
      const address = document.getElementById('address').value.trim();
      const feedback = document.getElementById('addressFeedback');
      const zoningSection = document.getElementById('zoningSection');
      const scopeSection = document.getElementById('scopeSection');
      const zoningInfo = document.getElementById('zoningInfo');
      const scope = document.getElementById('scope');

      // Reset feedback and sections
      feedback.textContent = "";
      zoningSection.classList.add('hidden');
      scopeSection.classList.add('hidden');
      scope.innerHTML = '<option value="" disabled selected>Select Scope</option>'; // Reset scope options

      if (mockDatabase[address]) {
        // Valid address
        feedback.textContent = "Address found!";
        feedback.className = "success";

        // Display zoning information
        zoningInfo.textContent = mockDatabase[address].zoning;
        zoningSection.classList.remove('hidden');

        // Populate permit scope options
        const permits = mockDatabase[address].permits;
        permits.forEach(permit => {
          const option = document.createElement('option');
          option.value = permit;
          option.textContent = formatPermitName(permit);
          scope.appendChild(option);
        });
        scopeSection.classList.remove('hidden');
      } else {
        // Invalid address
        feedback.textContent = "Address not found. Please try again.";
        feedback.className = "error";
      }
    }

    // Format permit names for display
    function formatPermitName(permit) {
      return permit.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
    }

    // Update requirements based on scope
    function updateRequirements() {
      const scope = document.getElementById('scope').value;
      const requirementsList = document.getElementById('requirementsList');
      requirementsList.innerHTML = ''; // Clear previous entries

      if (documentRequirements[scope]) {
        documentRequirements[scope].forEach(doc => {
          const li = document.createElement('li');
          li.textContent = doc;
          requirementsList.appendChild(li);
        });
        document.getElementById('requirementsSection').classList.remove('hidden');
      }
    }
  </script>
</body>
</html>
